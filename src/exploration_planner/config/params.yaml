# ==============================================================================
# EXPLORATION PLANNER PARAMETERS
#
# Tum node'lar bu dosyadan parametre ceker
# Tek bir yerde degistir, tum sistem guncellenir
# ==============================================================================

/**:
  ros__parameters:
    # ==========================================================================
    # GLOBAL MOTION LIMITS
    # ==========================================================================
    v_max: 2.0               # [m/s] Maximum linear velocity
    yaw_rate_max: 1.5        # [rad/s] Maximum yaw rate (~86 deg/s)

    a_max: 0.5               # [m/s²] Max linear acceleration
    yaw_accel_max: 0.8       # [rad/s²] Max yaw acceleration

    # ==========================================================================
    # ROBOT FOOTPRINT
    # ==========================================================================
    robot_width: 1.0         # [m] Drone width (X axis)
    robot_length: 1.0        # [m] Drone length (Y axis)
    robot_height: 0.3        # [m] Drone height (for visualization)

    # ==========================================================================
    # FRONTIER SELECTION (Greedy Selector)
    # ==========================================================================
    # cost = w_distance * dist + w_size * (1/size) + w_angle * angle + w_coverage * (1/cov)
    # Lower cost = better frontier

    # Topic parameters
    input_topic: "frontier_clusters_with_viewpoints"
    odom_topic: "/odom"
    output_topic: "/exploration/global_tour"

    # Cost weights
    w_distance: 2.0          # Distance penalty
    w_size: 0.02             # Small cluster penalty
    w_angle: 0.4             # Direction change penalty
    w_coverage: 0.4          # Low coverage penalty

    max_viewpoints_to_evaluate: 5  # Evaluate top N viewpoints per cluster

    # ==========================================================================
    # YAW INJECTION (Path Yaw Injector)
    # ==========================================================================
    # Smooth Yaw Distribution Along Path:
    #   Initial segment: current_yaw → movement_direction
    #   Middle segment: movement_direction (face forward)
    #   Final segment: movement_direction → target_yaw
    yaw_initial_blend_dist: 1.0   # [m] Initial blend distance
    yaw_final_blend_dist: 2.5     # [m] Final blend distance

    # ==========================================================================
    # TRAJECTORY FOLLOWER (Pure Pursuit Algorithm)
    # ==========================================================================
    # Pure Pursuit: Follows path precisely without shortcuts
    #   1. Finds closest point on path
    #   2. Targets lookahead point ahead on path
    #   3. Ensures UAV stays on path

    control_rate: 30.0            # [Hz] Control loop frequency
    goal_tolerance_xy: 0.15       # [m] Position tolerance
    goal_tolerance_yaw: 0.1       # [rad] Yaw tolerance (~5.7 deg)

    # Pure Pursuit Parameters
    lookahead_distance: 1.0       # [m] Base lookahead distance
    min_lookahead_distance: 0.2   # [m] Minimum lookahead (at low speed)
    lookahead_gain: 0.4           # Lookahead = base + gain * velocity

    # PD Gains - Proportional + Derivative for smooth control
    kp_linear: 1.0                # Position proportional gain
    kd_linear: 0.6                # Position derivative gain
    kp_yaw: 1.0                   # Yaw proportional gain
    kd_yaw: 0.5                   # Yaw derivative gain

    # Smoothing parameters
    velocity_smoothing: 0.25      # Exponential smoothing factor
    slowdown_distance: 1.0        # [m] Start slowing before goal
    min_approach_speed: 0.4       # [m/s] Minimum speed when approaching

    # ==========================================================================
    # HEIGHT CONTROL
    # ==========================================================================
    target_height: 1.5            # [m] Target flight height
    height_tolerance: 0.2         # [m] Acceptable height error
    kp_z: 1.0                     # Z-axis proportional gain
    vz_max: 1.0                   # [m/s] Maximum vertical speed

    # ==========================================================================
    # PATH TRAIL VISUALIZATION
    # ==========================================================================
    trail_enabled: true           # Enable trail visualization
    trail_max_points: 5000        # Maximum trail points (FIFO)
    trail_min_distance: 0.1       # [m] Minimum distance between trail points

    # ==========================================================================
    # TELEMETRY NODE
    # ==========================================================================
    publish_rate: 30.0            # [Hz] Telemetry publish frequency
    logging_enabled: false        # CSV logging enabled/disabled
    log_file_path: "/tmp/exploration_telemetry.csv"  # CSV log file path

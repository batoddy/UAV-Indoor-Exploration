# Frontier Exploration Parameters
# Tum node'lar bu dosyadan parametre alir

# ============ Node 1: Frontier Detector ============
frontier_detector:
  ros__parameters:
    # Topic parameters
    map_topic: "/projected_map"
    output_topic: "frontier_clusters"

    # Clustering parameters
    min_frontier_size: 3       # Min cells for valid cluster (düşürüldü: küçük frontier'lar da algılansın)
    max_cluster_size: 27       # Max cells before PCA split
    free_threshold: 25         # Occupancy < this = free
    occupied_threshold: 65     # Occupancy >= this = occupied
    pca_split_threshold: 2.0   # Eigenvalue threshold for splitting
    require_occupied_neighbor: false  # Filter frontiers without occupied neighbors

# ============ Node 2: Viewpoint Generator ============
viewpoint_generator:
  ros__parameters:
    # Topic parameters
    map_topic: "/projected_map"
    input_topic: "frontier_clusters"
    output_topic: "frontier_clusters_with_viewpoints"

    # Sensor model
    sensor_range: 7.0          # Max sensing range (m)
    sensor_fov_h: 1.57         # Horizontal FOV (~90°)

    # Cylindrical sampling
    min_dist: 1.0              # Min distance from cluster (safety buffer)
    max_dist: 3.0              # Max distance from cluster
    num_dist_samples: 5        # Radial samples
    num_angle_samples: 16      # Angular samples around cluster

    # Filtering
    min_coverage: 5            # Min visible cells (absolute minimum)
    max_viewpoints: 5          # Max VPs per cluster (artırıldı: daha fazla seçenek)

    free_threshold: 25
    occupied_threshold: 65

    # Robot footprint - for collision checking
    robot_width: 1.0           # [m] Robot width (X axis)
    robot_length: 1.0          # [m] Robot length (Y axis)
    robot_height: 0.3          # [m] Robot height (Z axis) - for 3D check
    safety_margin: 0.3         # [m] Extra clearance around robot

    # 3D checking parameters
    flight_height: 1.5         # [m] Nominal flight height
    height_tolerance: 0.5      # [m] Check obstacles in this Z range

    # Viewpoint stabilization
    vp_stabilization_enabled: false
    vp_hysteresis_distance: 1.0   # [m] Keep old VP if new one is within this distance
    vp_hysteresis_coverage: 1.3   # Multiplier: new must be > old * this to replace
    vp_tracking_timeout: 5.0      # [s] Reset tracking after this timeout

    # Occlusion-aware coverage
    occlusion_enabled: true
    occlusion_angle_bin_rad: 0.02  # Angular bin size for ray binning (~1.15°)
    yaw_samples: 36                # Yaw optimization samples

    # Viewpoint Quality Filters
    # These prevent viewpoints from being placed behind obstacles
    min_los_frontier_cells: 3      # Min frontier cells with LOS required (0 to disable)
    min_coverage_ratio: 0.2        # 20% of frontier cells must be visible
    use_normal_sampling: false      # Only sample viewpoints on the "free space" side
    normal_angle_range: 2.094      # Sample within +/-60 of normal (120 total)

# ============ Node 3: Frontier Visualizer ============
frontier_visualizer:
  ros__parameters:
    # Topic parameters
    input_topic: "frontier_clusters_with_viewpoints"
    marker_topic: "frontier_markers"
    info_topic: "fis_info"
